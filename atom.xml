<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[蛰渊-成长的轨迹]]></title>
  <link href="http://hiberabyss.github.io/atom.xml" rel="self"/>
  <link href="http://hiberabyss.github.io/"/>
  <updated>2013-06-25T18:15:05+08:00</updated>
  <id>http://hiberabyss.github.io/</id>
  <author>
    <name><![CDATA[hiberabyss]]></name>
    <email><![CDATA[liuhb90@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Markdown和kramdown语法总结]]></title>
    <link href="http://hiberabyss.github.io/blog/20130625/markdown-syntax/"/>
    <updated>2013-06-25T15:20:00+08:00</updated>
    <id>http://hiberabyss.github.io/blog/20130625/markdown-syntax</id>
    <content type="html"><![CDATA[<h3 id="more--"><code>&lt;!--more--&gt;</code>可以用来在只在首页展示部分内容，并添加一个按钮。</h3>

<h2 id="latex">Latex语法</h2>
<p>插入以下代码：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
</pre></td><td class="code"><pre><code class="latex"><span class="line"><span class="sb">$$</span><span class="nb"></span>
</span><span class="line"><span class="nv">\begin</span><span class="nb">{align</span><span class="o">*</span><span class="nb">}</span>
</span><span class="line"><span class="nb">  &amp; </span><span class="nv">\phi</span><span class="o">(</span><span class="nb">x,y</span><span class="o">)</span><span class="nb"> </span><span class="o">=</span><span class="nb"> </span><span class="nv">\phi</span><span class="nb"> </span><span class="nv">\left</span><span class="o">(</span><span class="nv">\sum</span><span class="nb">_{i</span><span class="o">=</span><span class="m">1</span><span class="nb">}^n x_ie_i, </span><span class="nv">\sum</span><span class="nb">_{j</span><span class="o">=</span><span class="m">1</span><span class="nb">}^n y_je_j </span><span class="nv">\right</span><span class="o">)</span><span class="nb"></span>
</span><span class="line"><span class="nb">  </span><span class="o">=</span><span class="nb"> </span><span class="nv">\sum</span><span class="nb">_{i</span><span class="o">=</span><span class="m">1</span><span class="nb">}^n </span><span class="nv">\sum</span><span class="nb">_{j</span><span class="o">=</span><span class="m">1</span><span class="nb">}^n x_i y_j </span><span class="nv">\phi</span><span class="o">(</span><span class="nb">e_i, e_j</span><span class="o">)</span><span class="nb"> </span><span class="o">=</span><span class="nb"> </span><span class="nv">\\</span><span class="nb"></span>
</span><span class="line"><span class="nb">  &amp; </span><span class="o">(</span><span class="nb">x_</span><span class="m">1</span><span class="nb">, </span><span class="nv">\ldots</span><span class="nb">, x_n</span><span class="o">)</span><span class="nb"> </span><span class="nv">\left</span><span class="o">(</span><span class="nb"> </span><span class="nv">\begin</span><span class="nb">{array}{ccc}</span>
</span><span class="line"><span class="nb">      </span><span class="nv">\phi</span><span class="o">(</span><span class="nb">e_</span><span class="m">1</span><span class="nb">, e_</span><span class="m">1</span><span class="o">)</span><span class="nb"> &amp; </span><span class="nv">\cdots</span><span class="nb"> &amp; </span><span class="nv">\phi</span><span class="o">(</span><span class="nb">e_</span><span class="m">1</span><span class="nb">, e_n</span><span class="o">)</span><span class="nb"> </span><span class="nv">\\</span><span class="nb"></span>
</span><span class="line"><span class="nb">      </span><span class="nv">\vdots</span><span class="nb"> &amp; </span><span class="nv">\ddots</span><span class="nb"> &amp; </span><span class="nv">\vdots</span><span class="nb"> </span><span class="nv">\\</span><span class="nb"></span>
</span><span class="line"><span class="nb">      </span><span class="nv">\phi</span><span class="o">(</span><span class="nb">e_n, e_</span><span class="m">1</span><span class="o">)</span><span class="nb"> &amp; </span><span class="nv">\cdots</span><span class="nb"> &amp; </span><span class="nv">\phi</span><span class="o">(</span><span class="nb">e_n, e_n</span><span class="o">)</span><span class="nb"></span>
</span><span class="line"><span class="nb">    </span><span class="nv">\end</span><span class="nb">{array} </span><span class="nv">\right</span><span class="o">)</span><span class="nb"></span>
</span><span class="line"><span class="nb">  </span><span class="nv">\left</span><span class="o">(</span><span class="nb"> </span><span class="nv">\begin</span><span class="nb">{array}{c}</span>
</span><span class="line"><span class="nb">      y_</span><span class="m">1</span><span class="nb"> </span><span class="nv">\\</span><span class="nb"></span>
</span><span class="line"><span class="nb">      </span><span class="nv">\vdots</span><span class="nb"> </span><span class="nv">\\</span><span class="nb"></span>
</span><span class="line"><span class="nb">      y_n</span>
</span><span class="line"><span class="nb">    </span><span class="nv">\end</span><span class="nb">{array} </span><span class="nv">\right</span><span class="o">)</span><span class="nb"></span>
</span><span class="line"><span class="nv">\end</span><span class="nb">{align</span><span class="o">*</span><span class="nb">}</span>
</span><span class="line"><span class="s">$$</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>就会得到：
$$
\begin{align<em>}
  &amp; \phi(x,y) = \phi \left(\sum_{i=1}^n x_ie_i, \sum_{j=1}^n y_je_j \right)
  = \sum_{i=1}^n \sum_{j=1}^n x_i y_j \phi(e_i, e_j) = <br />
  &amp; (x_1, \ldots, x_n) \left( \begin{array}{ccc}
      \phi(e_1, e_1) &amp; \cdots &amp; \phi(e_1, e_n) <br />
      \vdots &amp; \ddots &amp; \vdots <br />
      \phi(e_n, e_1) &amp; \cdots &amp; \phi(e_n, e_n)
    \end{array} \right)
  \left( \begin{array}{c}
      y_1 <br />
      \vdots <br />
      y_n
    \end{array} \right)
\end{align</em>}
$$</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="latex"><span class="line">段内插入LaTeX代码是这样的：exp(−x22)，试试看看吧
</span></code></pre></td></tr></table></div></figure></notextile></div>

<blockquote>
  <p>段内插入LaTeX代码是这样的：exp(−x22)，试试看看吧</p>
</blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[个性化Octopress资源整理]]></title>
    <link href="http://hiberabyss.github.io/blog/20130624/my-octopress-configure/"/>
    <updated>2013-06-24T17:07:00+08:00</updated>
    <id>http://hiberabyss.github.io/blog/20130624/my-octopress-configure</id>
    <content type="html"><![CDATA[<p>所做个性化修改的资料整理总结。</p>

<!--more-->

<h2 id="section">修改导航栏名称</h2>
<p>修改<code>source/_includes/custom/navigation.html</code>文件即可：</p>

<h2 id="section-1">修改缩进方式</h2>
<p>修改文件<code>sass/custom/_layout.scss</code>，设置<code>$indented-lists: true</code>。</p>

<h2 id="section-2">去除 <strong>分类目录</strong> 和 <strong>近期文章</strong> 的下划线</h2>
<p>根据<a href="http://blog.eddie.com.tw/2011/12/05/add-catetories-to-sidebar-in-octopress/">这篇文章</a>修改。对<code>plugins/category_list.rb</code>文件中<code>style</code>变量做如下修改：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">style = "text-decoration:none; ..."</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>对文件<code>source/\_inclue/asides/recent\_postts.html</code>做如下修改：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"><span class="nt">&lt;a</span> <span class="na">style=</span><span class="s">&quot;text-decoration:none&quot;</span> <span class="na">href=</span><span class="s">&quot;#&quot;</span><span class="nt">&gt;</span>...<span class="nt">&lt;/a&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>也可以直接在这个文件里修改显示的名称，其他侧边栏插件修改方法类似。</p>

<h2 id="disqus">添加Disqus</h2>
<p>首先需要在<a href="http://www.disqus.com/">Disqus</a>上注册一个帐号，然后修改<code>\_config.yml</code>文件：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="html"><span class="line">#在Disgus官网控制面板中输入使用的网址后会生成一个shortname
</span><span class="line">disqus_short_name: hiberabyss	
</span><span class="line">disqus_show_comment_count: true
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-3">添加多说</h2>
<p>主要参考<a href="http://ihavanna.org/Internet/2013-02/add-duoshuo-commemt-system-into-octopress.html">这篇文章</a>。需要先在多看官网上<a href="http://duoshuo.com/create-site/">创建站点</a>（官网的上写的是我要安装，最开始被我给直接忽略了），在后台控制面板的工具选项的代码中可以获取<code>short\_name</code>，可能是和输入的域名是一致的，不太确定。</p>

<h2 id="section-4">国内的社会化工具</h2>
<ul>
  <li><a href="http://www.bshare.cn/">bshare</a>：分享按钮，本站使用的工具。  </li>
  <li><a href="http://duoshuo.com/">多说</a>：评论系统，本站使用的评论工具。</li>
  <li><a href="http://www.jiathis.com/">加网</a>：包括分享（加网）、评论（<a href="http://www.uyan.cc/">友言</a>）和推荐（<a href="http://www.ujian.cc/">友荐</a>）三个部分。有时间可以尝试下友荐，看着很不错。</li>
</ul>

<h2 id="kramdown">使用kramdown包</h2>
<p>安装kramdown包：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">gem</span> <span class="n">install</span> <span class="n">kramdown</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>修改配置文件<code>\_config.yml</code>，把<code>rdiscount</code>改为<code>kramdown</code>：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="yaml"><span class="line"><span class="l-Scalar-Plain">markdown</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">kramdown</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="latex">使用Latex</h2>
<p>修改支持Latex的方法参见<a href="http://yanping.me/cn/blog/2012/03/10/octopress-with-latex/">这篇文章</a>。</p>

<h2 id="section-5">总结</h2>
<p>有不少内容参考了[这篇文章]（http://www.yanjiuyanjiu.com/blog/20130402/）。把无法连接的Twitter、FaceBook之类的插件注释掉，否则会影响页面的加载速度。</p>

<h2 id="section-6">相关博客</h2>
<ul>
  <li><a href="http://yanping.me/cn/">雁起平沙的网络日志</a>  </li>
  <li><a href="http://whbzju.github.io/">知行录（github上有源码）</a></li>
  <li><a href="http://mrzhang.me/">MrZhang.me（做的比较玄的一个博客，有源代码）</a></li>
</ul>

<h2 id="section-7">参考资料</h2>
<p><a href="http://programus.github.io/blog/2012/03/03/add-weibo-sidebar-into-octopress/">为Octopress博客追加新浪微博侧栏</a><br />
<a href="http://blog.eddie.com.tw/2011/12/05/add-catetories-to-sidebar-in-octopress/">幫你的Octopress增加文章分類</a>
<a href="http://ihavanna.org/Internet/2013-02/add-duoshuo-commemt-system-into-octopress.html">为 Octopress 添加多说评论系统</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Lustre-2.3的安装与配置]]></title>
    <link href="http://hiberabyss.github.io/blog/20130624/lustre-configture/"/>
    <updated>2013-06-24T12:37:00+08:00</updated>
    <id>http://hiberabyss.github.io/blog/20130624/lustre-configture</id>
    <content type="html"><![CDATA[<p>Lustre是一个分布式文件系统，由MDS（元数据服务器）、OSS（对象存储服务器）和Client（客户端）三部分组成。其中MDS和OSS都可以有多个节点，通过MGS进行管理，MGS只能有一个。</p>

<h2 id="section">主要内容</h2>
<ul>
  <li>安装环境  </li>
  <li>Lustre的安装</li>
  <li>Lustre的配置</li>
  <li>用于Lustre管理的实用工具</li>
  <li>遇到的问题与解决方案</li>
  <li>有创意的Idea</li>
</ul>

<!--more-->

<h2 id="section-1">安装环境</h2>
<ul>
  <li>操作系统：CentOS 6.3 (x86_64)</li>
  <li>内核版本：2.6.32-279</li>
  <li>Lustre版本：2.3</li>
  <li>Lustre节点：一个MGS和MDT，使用同一个服务器；多个OSS。</li>
</ul>

<h2 id="lustre">Lustre的安装</h2>
<p>安装之前，对系统环境有如下要求：   </p>

<ol>
  <li>必须已安装<em>net-snmp</em>，否则在安装<em>lustre-version.rpm</em>时会报错；</li>
  <li>selinux必须被设置为disabled，如果未关闭则在<em>mkfs.lustre</em>操作时会报错；可通过sestatus查看selinux当前状态，如果为enforcing则表示未关闭；可通过命令<code>setenforce [permissive|0]</code>临时性关闭;永久关闭则需要修改配置文件<em>/etc/selinux/config</em>，做如下修改重启后生效：</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">SELINUX</span><span class="o">=</span>disabled
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>下载<a href="http://downloads.whamcloud.com/public/e2fsprogs/latest/el6/RPMS/x86_64/">e2fsprogs</a>并安装：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">rpm -Uvh --nodeps <span class="se">\</span>
</span><span class="line">e2fsprogs-devel-1.42.7.wc1-7.el6.x86_64.rpm <span class="se">\</span>
</span><span class="line">e2fsprogs-libs-1.42.7.wc1-7.el6.x86_64.rpm <span class="se">\</span>
</span><span class="line">e2fsprogs-1.42.7.wc1-7.el6.x86_64.rpm <span class="se">\</span>
</span><span class="line">libcom_err-devel-1.42.7.wc1-7.el6.x86_64.rpm <span class="se">\</span>
</span><span class="line">libcom_err-1.42.7.wc1-7.el6.x86_64.rpm <span class="se">\</span>
</span><span class="line">libss-devel-1.42.7.wc1-7.el6.x86_64.rpm <span class="se">\</span>
</span><span class="line">libss-1.42.7.wc1-7.el6.x86_64.rpm
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>下载<a href="http://downloads.whamcloud.com/public/lustre/lustre-2.3.0/el6/server/RPMS/x86_64/">kernel</a>包并安装（如果要使用InfiniBind连接方式，则必须安装kernel-ib-version包，且需要卸载系统中已经安装的以mlnx开头的kenel包）：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">rpm -ivh <span class="se">\</span>
</span><span class="line">kernel-firmware-2.6.32-279.5.1.el6_lustre.gb16fe80.x86_64.rpm <span class="se">\</span>
</span><span class="line">kernel-devel-2.6.32-279.5.1.el6_lustre.gb16fe80.x86_64.rpm <span class="se">\</span>
</span><span class="line">kernel-2.6.32-279.5.1.el6_lustre.gb16fe80.x86_64.rpm <span class="se">\</span>
</span><span class="line">kernel-ib-version
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>下载并安装<a href="http://downloads.whamcloud.com/public/lustre/lustre-2.3.0/el6/server/RPMS/x86_64/">Lustre</a>：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">rpm -ivh <span class="se">\</span>
</span><span class="line">lustre-ldiskfs-3.3.0-2.6.32_279.5.1.el6_lustre.gb16fe80.x86_64.x86_64.rpm <span class="se">\</span>
</span><span class="line">lustre-modules-2.3.0-2.6.32_279.5.1.el6_lustre.gb16fe80.x86_64.x86_64.rpm <span class="se">\</span>
</span><span class="line">lustre-2.3.0-2.6.32_279.5.1.el6_lustre.gb16fe80.x86_64.x86_64.rpm
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="lustre-1">Lustre的配置</h2>
<p>配置Lustre所使用的借口名称以及相对应的别名；创建<em>/etc/modprobe.d/lnet.conf</em>文件，写入以下内容：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">options lnet <span class="nv">networks</span><span class="o">=</span><span class="s2">&quot;o2ib0(ib0)&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>载入相关模块：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">modprobe lustre
</span><span class="line">modprobe ldiskfs
</span><span class="line">modprobe lnet
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>这时可以查看<em>/sys/modules/lnet/prarameters/networks</em>内容，以确定<em>lnet.conf</em>中的配置信息是否已经加载至内核。</p>

<p>在MDS上的创建Lustre文件系统，并挂载：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">mkfs.lustre --fsname<span class="o">=</span>mylustre --mdt --mgs --index<span class="o">=</span>0 --reformat /dev/sdb1
</span><span class="line">mount.lustre /dev/sdb1 /mnt/mdt
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>其中<em>fsname</em>为安装的lustre文件系统的标志，在MGS、MDS和OSS中都必须保持一致，在客户端挂在Lustre文件系统时也会使用到这个名字，长度不能超过8个字符；本例中MGS和MDS使用同一个服务器；<em>reformat</em>会对磁盘进行重新格式化处理。</p>

<p>在OSS上创建Lustre文件系统，并挂载：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">mkfs.lustre --fsname<span class="o">=</span>mylustre --ost --reformat --index<span class="o">=</span>num --mgsnode<span class="o">=</span>host_mds@o2ib0 /dev/sdb2
</span><span class="line">mount.lustre /dev/sdb2 /mnt/ost
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>必须要在MDT的文件系统挂在之后才能挂载OST的文件系统；<em>host_mds</em>为mds的ip地址或者已经写入<em>hosts</em>文件的主机名，<em>o2ib0</em>和<em>lnet.conf</em>中写入的内容保持一致。
如果出现无法连接的情况，则可能是防火墙的原因，可以关闭<em>iptables</em>服务：<code>service iptables stop</code></p>

<p>客户端的挂载：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">mount.lustre host_mds@o2ib0:/mylustre /mnt/lustre
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-2">实用工具</h2>
<p>lctl：可以直接在终端运行进入交互的命令方式或者直接输入命令。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">lctl network up
</span><span class="line">lctl list_nids	<span class="c">#可以查看当前实际的ip地址，以确定是否使用了正确的接口</span>
</span><span class="line">lctl ping nids	<span class="c">#用来检查OSS和MGS连接是否正常</span>
</span><span class="line">lctl dl		<span class="c">#查看当前的设备</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>可以通过<em>lfs</em>命令获取已挂载的<em>lustre</em>文件系统信息：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">lfs df -h
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>或者对文件系统的文件写入方式等进行配置：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">lfs setstripe -c -1 -S 128M /mnt/lustre/
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>其中<code>-c -1</code>表示写入到所有的OSS中，<code>-S 128M</code>表示文件分块的大小为128M；上面是对整个文件系统进行设置，也可以单独地对某个文件或者文件夹进行设置；设置完后可以通过如下命令查看配置信息是否正确：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">lfs getstripe /mnt/lustre
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="p-problemc-causer-resolve">遇到的问题及解决方法（P-Problem，C-Cause，R-Resolve）</h2>
<p>P：安装完重启之后，系统无法启动。<br />
C：因为启动分区太小，只有100M大小，而<em>Lustre</em>生成的<em>initramfs</em>太大，大概有65M，最后导致生成的文件不完整，所以无法启动；在<em>lustre-module-version</em>的安装过程中产生，会报文件写入错误。<br />
R：调整分区大小比较困难，也不方便进行批量处理；就不是用单独的启动分区，把<em>grub</em>重新安装到<em>/dev/sda</em>上，卸载启动分区，把内核等文件复制到根文件系统的<em>/boot</em>目录下，修改<em>grub.conf</em>文件，直接通过根文件系统下的<em>/boot</em>目录中的内核进行启动。  </p>

<p>P：安装完Lustre并成功启动后，在执行<em>mount.lustre</em>操作之后，就会断开了ssh连接。<br />
C：主机上提示<em>out of memory</em>提示，并killing一大堆进程，至今没搞明白为什么会出现内存不足的问题，当时机器的配置是2G内存，我在虚拟机中实验时，设置1G的内存，也没有出现这个错误。<br />
R：去除内核参数<em>mem=2048M</em>之后，内存变为了32G，一切就恢复正常了。  </p>

<h2 id="idea">比较有创意的Idea</h2>
<p>需要对<em>/dev/sdb</em>进行分区，就在一台机器上利用<code>fdisk</code>按要求分区后，拷贝出该硬盘前512字节启动分区内容：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">dd <span class="k">if</span><span class="o">=</span>/dev/sdb <span class="nv">of</span><span class="o">=</span>boot512.img <span class="nv">bs</span><span class="o">=</span>512 <span class="nv">count</span><span class="o">=</span>1
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>之后把这个文件写入其他机器的<em>/dev/sdb</em>硬盘，便可完成分区，这样便方便进行批量处理了：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">dd <span class="k">if</span><span class="o">=</span>boot512.img <span class="nv">of</span><span class="o">=</span>/dev/sdb <span class="nv">bs</span><span class="o">=</span>512 <span class="nv">count</span><span class="o">=</span>1
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>在用<code>fdisk</code>分完区后，在<em>/dev/sdb#</em>中并没有及时地反映出分区后的结果，此时运行<code>partprobe /dev/sdb</code>命令即可。</p>

<h2 id="section-3">参考文献：</h2>
<p><a href="http://xiaolangit.blog.51cto.com/3343422/1195060">51CTO：Lustre-2.3的安装</a></p>
]]></content>
  </entry>
  
</feed>
