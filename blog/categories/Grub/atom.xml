<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Grub | 蛰渊-成长的轨迹]]></title>
  <link href="http://hiberabyss.github.io/blog/categories/Grub/atom.xml" rel="self"/>
  <link href="http://hiberabyss.github.io/"/>
  <updated>2013-07-23T12:54:35+08:00</updated>
  <id>http://hiberabyss.github.io/</id>
  <author>
    <name><![CDATA[hiberabyss]]></name>
    <email><![CDATA[liuhb90@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[利用Grub2安装启动操作系统]]></title>
    <link href="http://hiberabyss.github.io/blog/20130712/grub/"/>
    <updated>2013-07-12T09:28:00+08:00</updated>
    <id>http://hiberabyss.github.io/blog/20130712/grub</id>
    <content type="html"><![CDATA[<p>本文介绍如何利用<code>Grub2</code>进行操作系统的启动、安装等。</p>

<!--more-->

<h2 id="ubuntu">安装Ubuntu</h2>

<p><code>
menuentry 'Install Ubuntu' --hotkey='i' {
    set isofile="/iso/ubuntu.iso"
    search --set=root -f $isofile --hint (hd0,1)
    loopback loop $isofile
    linux (loop)/casper/vmlinuz boot=casper iso-scan/filename=$isofile noprompt noeject
    initrd (loop)/casper/initrd.lz
}
</code></p>

<h2 id="isocentos">利用iso安装CentOS操作系统</h2>
<p>复制iso文件根目录下<code>images</code>文件夹到U盘根目录，复制<code>isolinux</code>文件夹到U盘根目录（并非必须，可以利用grub2挂载iso文件后进行使用，但直接复制到u盘可以不用指定iso文件名，要方便很多），复制iso文件到U盘根目录。</p>

<p>iso文件和<code>images</code>文件夹需要在同一分区，需要把该分区格式化为<code>fat32</code>或<code>ext#</code>格式，因为CentOS6.3安装时不支持ntfs格式分区。</p>

<p>安装时只需加载内核和初始文件系统即可，在安装界面选择<code>images</code>文件夹所在的分区。如果在安装过程中提示<code>未找到images#</code>之类的错误，则可能是没有找到iso文件，按<code>alt-F2</code>切换到<code>anaconda</code>字符界面，手动加载iso文件所在的分区到<code>/mnt/isodir</code>目录。</p>

<p>具体的启动配置文件见示例<code>grub.cfg</code>文件。</p>

<p>PS：抽时间研究一下<code>anaconda</code>，以及如何利用<code>http</code>、<code>ftp</code>网络安装的方式安装操作系统。利用<code>kickstart</code>可以进行全自动安装。</p>

<h2 id="memdiskwinpe">利用memdisk启动WinPE</h2>
<p>需要先下载<code>memdisk</code>文件。具体用法参见<a href="http://www.syslinux.org/wiki/index.php/MEMDISK">syslinux</a>。</p>

<p><code>
menuentry 'Win7PE' {
  MEMDISK_LOC="/boot/memdisk"
  search --set=root -f $MEMDISK_LOC --hint (hd0,1)
  echo 'Loading Memdisk...'
  insmod memdisk
  linux16 /boot/memdisk iso raw
  echo 'Loading PE...'
  initrd16 /iso/WIN7PE.ISO
}
</code></p>

<h2 id="linux">启动Linux</h2>
<p>需要先利用<code>linux</code>指定内核文件，该文件一般以<code>vmlinuz</code>开头，注意加上<code>root=/dev/sda3</code>之类的内核参数，指定根分区；然后利用<code>initrd</code>指定初始文件系统，该文件一般以<code>initrd</code>开头。</p>

<h2 id="grub-rescue">Grub Rescue</h2>

<p><code>lang
set prefix=(hd0,msdos#)/boot/grub
insmod normal
normal
</code></p>

<h2 id="grubcfggrub2">示例grub.cfg配置文件（grub2）</h2>

<p>{% codeblock mydata/grub/grub.cfg %}
	{% render_partial mydata/grub/grub.cfg raw%}
{% endcodeblock %}</p>

]]></content>
  </entry>
  
</feed>
